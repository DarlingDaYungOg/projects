#include "TXLib.h"
int t = 0;
int winLength = 800;
int winWidth = 600;

struct Boy {
    int dir = 0;
    int dx = 0, dy = 0, x = 100, y = 100;
    int areaLength, areaWidth;
    HDC pic;

    void draw();
    void move();
};




int main() {
    txCreateWindow (800, 600);
    txTextCursor (false);
    txBegin();

    Boy boy;
    boy.pic = txLoadImage("sprite.bmp");
    boy.areaLength = 30;
    boy.areaWidth = 31;


    while (true) {
        txSetFillColor (TX_GREEN);
        txClear();
        boy.draw();
        txSleep (50);
        if (txGetAsyncKeyState ('W')){
            boy.dx = 0;
            boy.dy = -5;
            boy.dir = 3;
        }
        if (txGetAsyncKeyState ('S')){
            boy.dx = 0;
            boy.dy = 5;
            boy.dir = 0;
        }
        if (txGetAsyncKeyState ('A')){
            boy.dx = -5;
            boy.dy = 0;
            boy.dir = 1;
        }
        if (txGetAsyncKeyState ('D')){
            boy.dx = 5;
            boy.dy = 0;
            boy.dir = 2;
        }
        boy.move();

    }
}

void Boy::draw() {
     txTransparentBlt (txDC(), x, y, areaLength, areaWidth, pic, t % 3 * 31, 32 * dir, TX_WHITE);
}

void Boy::move() {
    x += dx;
    y += dy;

    if (x <= 0 - areaLength)
       x = winLength;
    if (x + areaLength >= winLength)
    //    x = winLength - areaLength;
    //if (y <= 0)
      //  y = 0;
    //if (y + areaWidth >= winWidth)
        //y = winWidth - areaWidth;
    t += 1;
}
